<?xml version="1.0" encoding="UTF-8"?>
<!--
    Đây là file cấu hình web.xml cho ứng dụng web Java Servlet (Tomcat).
    Nó định nghĩa servlet, mapping, cấu hình session, và trang lỗi cho ứng dụng.
    Tomcat sẽ ưu tiên sử dụng file này để cấu hình ứng dụng web.
    Phiên bản schema là 4.0, tương thích với Servlet 4.0
    và JSP 2.3.
    Bạn có thể tham khảo thêm tại: https://docs.oracle.com/javaee/7/tutorial
    /webapp-structure.htm#GJHFF
    và https://docs.oracle.com/javaee/7/tutorial/jsp-intro.htm#JSPAD100
-->
<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee
         http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
         version="4.0">

    <!--
        Đăng ký servlet mặc định của JSP.
        org.apache.jasper.servlet.JspServlet là class chịu trách nhiệm biên dịch và chạy các file JSP.
        Các tham số init-param dưới đây là các tuỳ chỉnh cho servlet này:
        - fork: Có chạy JSP trên process riêng không (thường để false).
        - xpoweredBy: Có hiện header X-Powered-By trong response không (thường để false).
        - development: Nếu để true thì JSP sẽ tự động reload khi thay đổi file (dùng cho dev), false thì tốt cho production.
        - load-on-startup: Số thứ tự ưu tiên khởi động servlet này khi khởi động server, số càng nhỏ càng ưu tiên.
    -->
    <servlet>
        <servlet-name>jsp</servlet-name>
        <servlet-class>org.apache.jasper.servlet.JspServlet</servlet-class>
        <init-param>
            <param-name>fork</param-name>
            <param-value>false</param-value>
        </init-param>
        <init-param>
            <param-name>xpoweredBy</param-name>
            <param-value>false</param-value>
        </init-param>
        <init-param>
            <param-name>development</param-name>
            <param-value>false</param-value>
        </init-param>
        <load-on-startup>3</load-on-startup>
    </servlet>

    <!--
        Mapping các URL có đuôi .jsp và .jspx tới servlet JSP đã đăng ký ở trên.
        Khi người dùng truy cập các file .jsp hoặc .jspx, Tomcat sẽ dùng org.apache.jasper.servlet.JspServlet để xử lý.
    -->
    <servlet-mapping>
        <servlet-name>jsp</servlet-name>
        <url-pattern>*.jsp</url-pattern>
        <url-pattern>*.jspx</url-pattern>
    </servlet-mapping>

    <!--    START HOME SERVLET-->
    <servlet>
        <servlet-name>HomeServlet</servlet-name>
        <servlet-class>com.ecm.home.HomeServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>HomeServlet</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>
    <servlet>
        <servlet-name>HomePageServlet</servlet-name>
        <servlet-class>com.ecm.home.HomePageServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>HomePageServlet</servlet-name>
        <url-pattern>/home</url-pattern>
    </servlet-mapping>
    <!--    END HOME SERVLET-->

    <!--
        Cấu hình trang lỗi cho ứng dụng:
        - Nếu server trả về lỗi code 500 (lỗi hệ thống), sẽ chuyển sang trang /error.jsp.
        - Nếu có exception kiểu java.lang.Exception xảy ra, cũng chuyển sang /error.jsp.
        Bạn nên tạo file error.jsp để hiển thị thông báo cho người dùng.
    -->
    <error-page>
        <error-code>404</error-code>
        <location>/error/404.jsp</location>
    </error-page>

    <error-page>
        <error-code>500</error-code>
        <location>/error/404.jsp</location>
    </error-page>

    <error-page>
        <exception-type>java.lang.Exception</exception-type>
        <location>/error/404.jsp</location>
    </error-page>

    <!--
        Cấu hình session cho ứng dụng:
        - session-timeout: Thời gian hết hạn phiên (tính bằng phút). Ở đây đặt là 30 phút.
        - cookie-config: Cấu hình bảo mật cho cookie phiên.
            + http-only: Nếu true, cookie chỉ được truy cập bởi trình duyệt, không bởi JS.
            + secure: Nếu true, cookie chỉ được gửi qua HTTPS. Ở đây là false.
    -->
    <session-config>
        <session-timeout>30</session-timeout>
        <cookie-config>
            <http-only>true</http-only>
            <secure>false</secure>
        </cookie-config>
    </session-config>
</web-app>